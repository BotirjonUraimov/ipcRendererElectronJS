<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';">
  <title>Your Electron App</title>
  <style>
    #rgb-container img, #depth-container img {
      width: 100%;
      height: auto;
    }
  </style>
</head>
<body>
  <h1>Hello from Electron!</h1>
  <h2>RealSense Frames Display</h2>
  <button id="start-server">Start Server</button>
<button id="stop-server">Stop Server</button>
  <div id="rgb-container">
    <img id="rgb-image" src="" alt="RGB Frame">
  </div>
  <div id="depth-container">
    <img id="depth-image" src="" alt="Depth Frame">
  </div>
  <button id="save-rgb">Save RGB Image</button>
  <button id="save-depth">Save Depth Image</button>

  <script>
    const { ipcRenderer } = require('electron');
    const fs = require('fs');


    function saveImage(dataUrl, filename) {
    // Convert base64 to raw binary data held in a string
    const base64Data = dataUrl.replace(/^data:image\/jpeg;base64,/, "");
    
    // Write the file to disk
    fs.writeFile(filename, base64Data, 'base64', (err) => {
      if (err) alert('Error saving the image: ' + err.message);
      else alert('Image saved successfully!');
    });
  }

    ipcRenderer.on('frame-data', (event, frameData) => {
      if (frameData.rgb) {
        const rgbImage = document.getElementById('rgb-image');
        rgbImage.src = `data:image/jpeg;base64,${frameData.rgb}`;

}
if (frameData.depth) {
    const depthImage = document.getElementById('depth-image');
    depthImage.src = `data:image/jpeg;base64,${frameData.depth}`;
  }
});

document.getElementById('save-rgb').addEventListener('click', () => {
    const rgbImage = document.getElementById('rgb-image');
    saveImage(rgbImage.src, 'rgb-image.jpg');
  });

  document.getElementById('save-depth').addEventListener('click', () => {
    const depthImage = document.getElementById('depth-image');
    saveImage(depthImage.src, 'depth-image.jpg');
  });

  document.getElementById('start-server').addEventListener('click', () => {
    ipcRenderer.send('start-server');
  });


  document.getElementById('stop-server').addEventListener('click', () => {
    ipcRenderer.send('stop-server');
  });

  ipcRenderer.on('server-status', (event, status) => {
    console.log('Server status:', status);
    // Update UI based on server status
  });


</script>
</body>
</html>